<div class="columns is-centered">
    <div class="column is-10">
        <div class="box">
            <h1 class="title">CARS Assessment</h1>
            <p class="subtitle">Please answer each question based on your experiences in the past month.</p>
            
            <div class="notification is-info">
                <p><strong>Instructions:</strong> For each statement, select how often it applies to you:</p>
                <ul>
                    <li><strong>Never (0):</strong> This never happens to me</li>
                    <li><strong>Rarely (1):</strong> This happens once in a while</li>
                    <li><strong>Occasionally (2):</strong> This happens sometimes</li>
                    <li><strong>Often (3):</strong> This happens frequently</li>
                    <li><strong>Almost Always (4):</strong> This happens most of the time</li>
                </ul>
            </div>
            
            <form method="POST" action="/assessment/submit" class="assessment-form">
                <% questions.forEach((question, index) => { %>
                    <div class="field">
                        <div class="box">
                            <label class="label">
                                <%= question.en %>
                            </label>
                            <p class="help"><em><%= question.tl %></em></p>
                            
                            <div class="control">
                                <% if (question.special) { %>
                                    <!-- Special Yes/No question for self-harm -->
                                    <label class="radio">
                                        <input type="radio" name="q<%= index %>" value="0" required>
                                        No / Hindi
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q<%= index %>" value="1">
                                        Yes / Oo
                                    </label>
                                <% } else { %>
                                    <!-- Regular 0-4 scale questions -->
                                    <% ratingOptions.forEach(option => { %>
                                        <label class="radio">
                                            <input type="radio" name="q<%= index %>" value="<%= option.value %>" required>
                                            <%= option.label %>
                                        </label>
                                    <% }) %>
                                <% } %>
                            </div>
                        </div>
                    </div>
                <% }) %>
                
                <div class="field">
                    <div class="control">
                        <button class="button is-primary is-large is-fullwidth" type="submit">
                            Submit Assessment
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
// Auto-save progress to localStorage
document.addEventListener('DOMContentLoaded', function() {
    const form = document.querySelector('.assessment-form');
    const inputs = form.querySelectorAll('input[type="radio"]');
    
    // Load saved answers
    inputs.forEach(input => {
        const saved = localStorage.getItem('cars_' + input.name);
        if (saved === input.value) {
            input.checked = true;
        }
    });
    
    // Save answers as user progresses
    inputs.forEach(input => {
        input.addEventListener('change', function() {
            localStorage.setItem('cars_' + this.name, this.value);
        });
    });
    
    // Clear localStorage on successful submit
    form.addEventListener('submit', function() {
        inputs.forEach(input => {
            localStorage.removeItem('cars_' + input.name);
        });
    });
});
</script>